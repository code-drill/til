<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Today I Learned</title><link>https://til.code-drill.eu/</link><description>Things I've learned, collected in code-drill/til.</description><atom:link href="https://til.code-drill.eu/rss.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2025 &lt;a href="mailto:michal@code-drill.eu"&gt;Michał Rutkowski&lt;/a&gt; </copyright><lastBuildDate>Sat, 12 Jul 2025 20:33:29 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>how serve static files on localhost</title><link>https://til.code-drill.eu/posts/2025-07-12/how-serve-static-files-on-localhost/</link><dc:creator>Michał Rutkowski</dc:creator><description>&lt;p&gt;How spin up http server to serve static files in a few seconds.&lt;/p&gt;
&lt;h3 id="using-python"&gt;Using &lt;code&gt;python&lt;/code&gt;&lt;/h3&gt;
&lt;pre class="shell"&gt;&lt;code&gt;python -m http.server 8000 --bind 127.0.0.1
python -m http.server --directory /path-to-dir-with-static-files/
python -m http.server 8000 --directory /path-to-dir-with-static-files/
python -m http.server 9106 --directory /path/to/dir/with/static/files&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id="using-npx"&gt;Using &lt;code&gt;npx&lt;/code&gt;&lt;/h3&gt;
&lt;pre class="shell"&gt;&lt;code&gt;npx http-server -p 7890 --cors="*" /path/to/dir/with/static/files&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id="using-docker"&gt;Using &lt;code&gt;docker&lt;/code&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;and &lt;code&gt;nginx&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;on windows&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="shell"&gt;&lt;code&gt;# Serve files from current directory
docker run -it --rm -p 8080:80 -v %cd%:/usr/share/nginx/html nginx:alpine 

# Serve files from specific directory
docker run -it --rm -p 8080:80 -v /path/to/your/files:/usr/share/nginx/html nginx:alpine&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;on linux&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="shell"&gt;&lt;code&gt;# Serve files from current directory
docker run -it --rm -p 8080:80 -v $(pwd):/usr/share/nginx/html nginx:alpine

# Serve files from specific directory
docker run -it --rm -p 8080:80 -v /path/to/your/files:/usr/share/nginx/html nginx:alpine&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;or &lt;code&gt;apache&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;on windows&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="shell"&gt;&lt;code&gt;# Serve files from current directory
docker run -it --rm -p 8080:80 -v %cd%:/usr/local/apache2/htdocs httpd:alpine

# Serve files from specific directory
docker run -it --rm -p 8080:80 -v /path/to/your/files:/usr/local/apache2/htdocs httpd:alpine&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;on linux&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="shell"&gt;&lt;code&gt;# Serve files from current directory
docker run -it --rm -p 8080:80 -v $(pwd):/usr/local/apache2/htdocs httpd:alpine

# Serve files from specific directory
docker run -it --rm -p 8080:80 -v /path/to/your/files:/usr/local/apache2/htdocs httpd:alpine&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;</description><category>development</category><category>docker</category><category>http</category><category>localhost</category><category>npx</category><category>python</category><category>server</category><guid>https://til.code-drill.eu/posts/2025-07-12/how-serve-static-files-on-localhost/</guid><pubDate>Sat, 12 Jul 2025 19:51:27 GMT</pubDate></item><item><title>how to detect aws ecs deployment failure</title><link>https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/</link><dc:creator>Michał Rutkowski</dc:creator><description>&lt;h1 id="deployment-issue-and-alert-configuration"&gt;Deployment Issue and
Alert Configuration&lt;/h1&gt;
&lt;p&gt;Recently we had an interesting issue.&lt;br&gt;
Due to an incorrect cloud config entry, one of our services fell into an
endless loop of failed deployments.&lt;/p&gt;
&lt;p&gt;So we had to add some kind of alerts to detect this in the
future.&lt;/p&gt;
&lt;p&gt;We are deploying our services on AWS ECS.&lt;br&gt;
As we are using &lt;a href="https://github.com/prometheus-community/yet-another-cloudwatch-exporter"&gt;yet-another-cloudwatch-exporter&lt;/a&gt;
to export CloudWatch metrics into Prometheus, the natural way was to
expose new metrics and add a Prometheus alert based on it.&lt;/p&gt;
&lt;p&gt;We exported one new metric from
&lt;code&gt;ECS/ContainerInsights&lt;/code&gt;:&lt;/p&gt;
&lt;div class="sourceCode" id="cb1"&gt;&lt;pre class="sourceCode yaml"&gt;&lt;code class="sourceCode yaml"&gt;&lt;span id="cb1-1"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb1-1" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;apiVersion&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; v1alpha1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-2"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb1-2" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# [...]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-3"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb1-3" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;discovery&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-4"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb1-4" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;  &lt;/span&gt;&lt;span class="fu"&gt;jobs&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-5"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb1-5" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;    &lt;/span&gt;&lt;span class="kw"&gt;-&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="fu"&gt;type&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; ECS/ContainerInsights&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-6"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb1-6" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;      &lt;/span&gt;&lt;span class="fu"&gt;regions&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-7"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb1-7" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;        &lt;/span&gt;&lt;span class="kw"&gt;-&lt;/span&gt;&lt;span class="at"&gt; eu-west-1&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-8"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb1-8" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;      &lt;/span&gt;&lt;span class="fu"&gt;dimensionNameRequirements&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="kw"&gt;[&lt;/span&gt;&lt;span class="at"&gt;ClusterName&lt;/span&gt;&lt;span class="kw"&gt;,&lt;/span&gt;&lt;span class="at"&gt; ServiceName&lt;/span&gt;&lt;span class="kw"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-9"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb1-9" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;      &lt;/span&gt;&lt;span class="fu"&gt;statistics&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="kw"&gt;[&lt;/span&gt;&lt;span class="at"&gt;Average&lt;/span&gt;&lt;span class="kw"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-10"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb1-10" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;      &lt;/span&gt;&lt;span class="fu"&gt;nilToZero&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="ch"&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-11"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb1-11" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;      &lt;/span&gt;&lt;span class="fu"&gt;addCloudwatchTimestamp&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="ch"&gt;false&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-12"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb1-12" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;      &lt;/span&gt;&lt;span class="fu"&gt;metrics&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-13"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb1-13" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;        &lt;/span&gt;&lt;span class="kw"&gt;-&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="fu"&gt;name&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; DeploymentCount&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb1-14"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb1-14" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# [...]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and added new config for Prometheus alerts to
&lt;code&gt;config/apps-alerts.yml&lt;/code&gt;:&lt;/p&gt;
&lt;div class="sourceCode" id="cb2"&gt;&lt;pre class="sourceCode yaml"&gt;&lt;code class="sourceCode yaml"&gt;&lt;span id="cb2-1"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb2-1" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="pp"&gt;---&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-2"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb2-2" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;groups&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-3"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb2-3" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;  &lt;/span&gt;&lt;span class="kw"&gt;-&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="fu"&gt;name&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; apps-alerts&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-4"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb2-4" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;    &lt;/span&gt;&lt;span class="fu"&gt;rules&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-5"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb2-5" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;      &lt;/span&gt;&lt;span class="kw"&gt;-&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="fu"&gt;alert&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; DeploymentAlert&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-6"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb2-6" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;        &lt;/span&gt;&lt;span class="fu"&gt;expr&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; sum by (dimension_ServiceName) (aws_ecs_containerinsights_deployment_count_average) &amp;gt;= 2&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-7"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb2-7" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;        &lt;/span&gt;&lt;span class="fu"&gt;for&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; 15m&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-8"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb2-8" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;        &lt;/span&gt;&lt;span class="fu"&gt;labels&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-9"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb2-9" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;          &lt;/span&gt;&lt;span class="fu"&gt;severity&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; page&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-10"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb2-10" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;        &lt;/span&gt;&lt;span class="fu"&gt;annotations&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb2-11"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb2-11" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="at"&gt;          &lt;/span&gt;&lt;span class="fu"&gt;summary&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;span class="at"&gt; &lt;/span&gt;&lt;span class="st"&gt;"Probable deployment problem: `{{ $labels.dimension_ServiceName }}`"&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and finally added new config to Prometheus env-based configs
(&lt;code&gt;prometheus-XXX-config.yml&lt;/code&gt;):&lt;/p&gt;
&lt;div class="sourceCode" id="cb3"&gt;&lt;pre class="sourceCode yaml"&gt;&lt;code class="sourceCode yaml"&gt;&lt;span id="cb3-1"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb3-1" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# [...]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-2"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb3-2" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="fu"&gt;rule_files&lt;/span&gt;&lt;span class="kw"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-3"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb3-3" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;  # [...]&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-4"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb3-4" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="kw"&gt;-&lt;/span&gt;&lt;span class="at"&gt; apps-alerts.yml&lt;/span&gt;&lt;/span&gt;
&lt;span id="cb3-5"&gt;&lt;a href="https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/#cb3-5" aria-hidden="true" tabindex="-1"&gt;&lt;/a&gt;&lt;span class="co"&gt;# [...]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now if there are some problems with failed deployments, we are seeing
notifications in our slack.&lt;/p&gt;</description><category>aws</category><category>cloudwatch</category><category>ecs</category><category>prometheus</category><guid>https://til.code-drill.eu/posts/2025-07-06/how-to-detect-aws-ecs-deployment-failure/</guid><pubDate>Sun, 06 Jul 2025 20:21:46 GMT</pubDate></item><item><title>how use multiple ssh keys with github</title><link>https://til.code-drill.eu/posts/2025-07-06/how-use-multiple-ssh-keys-with-git/</link><dc:creator>Michał Rutkowski</dc:creator><description>&lt;p&gt;Assuming that you have already configured one key to access GitHub
using SSH.&lt;/p&gt;
&lt;h3 id="step-1-create-additional-ssh-key"&gt;Step 1: Create Additional SSH
Key&lt;/h3&gt;
&lt;p&gt;Put an additional key in the SSH config directory, e.g.:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Windows:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;%USERPROFILE%/.ssh/some-name/id_ed25519&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Linux/macOS:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;~/.ssh/some-name/id_ed25519&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id="step-2-configure-ssh-config"&gt;Step 2: Configure SSH Config&lt;/h3&gt;
&lt;p&gt;Now you need to edit (or create) SSH config under:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Windows:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;%USERPROFILE%/.ssh/config&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Linux/macOS:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;~/.ssh/config&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Add additional config:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Host github-some-new-label
    HostName github.com
    User git
    IdentityFile c:\Users\USERNAME\.ssh\some-name\id_ed25519
    IdentitiesOnly yes&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id="caution"&gt;Caution&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;IdentityFile&lt;/code&gt; - must be full path to SSH key&lt;/p&gt;
&lt;h3 id="notice"&gt;Notice&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;IdentitiesOnly yes&lt;/code&gt; is a crucial SSH configuration option
that tells SSH to only use the specific key file you’ve specified and
ignore all other keys.&lt;/p&gt;
&lt;h4 id="without-identitiesonly-yes"&gt;Without
&lt;code&gt;IdentitiesOnly yes&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;SSH tries multiple keys in this order&lt;/p&gt;
&lt;ol type="1"&gt;
&lt;li&gt;Keys loaded in SSH agent&lt;/li&gt;
&lt;li&gt;Default keys (&lt;code&gt;~/.ssh/id_rsa&lt;/code&gt;,
&lt;code&gt;~/.ssh/id_ed25519&lt;/code&gt;, etc)&lt;/li&gt;
&lt;li&gt;Your specified key file&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;GitHub sees the first key that works and authenticates with that
account&lt;/p&gt;
&lt;h4 id="with-identitiesonly-yes"&gt;With
&lt;code&gt;IdentitiesOnly yes&lt;/code&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;SSH only uses the exact key file you specified&lt;/li&gt;
&lt;li&gt;It ignores SSH agent keys and default keys&lt;/li&gt;
&lt;li&gt;GitHub only sees your intended key&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="step-3-configure-repository"&gt;Step 3: Configure Repository&lt;/h3&gt;
&lt;p&gt;Go to repo that should use new key.&lt;/p&gt;
&lt;p&gt;Optionally set new git username and git email for given repo:&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;git config user.name "git username"
git config user.email "your.email@example.com"&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Update remote to use new GitHub config:&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;git remote set-url origin git@github-some-new-label:github-user/project1.git&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Where: - &lt;code&gt;github-some-new-label&lt;/code&gt; - is the same as label
after &lt;code&gt;Host&lt;/code&gt; in &lt;code&gt;.ssh/config&lt;/code&gt; -&amp;gt;
&lt;code&gt;Host github-some-new-label&lt;/code&gt; - &lt;code&gt;github-user&lt;/code&gt; is
GitHub user of appropriate repo; i.e., if https url is
&lt;code&gt;https://github.com/code-drill/django-app-template.git&lt;/code&gt; -&amp;gt;
then ssh link will be:
&lt;code&gt;git@github-code-drill:code-drill/django-app-template.git&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id="step-4-test-configuration"&gt;Step 4: Test Configuration&lt;/h3&gt;
&lt;p&gt;Test the SSH connection:&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;ssh -T git@github-some-new-label&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You should see:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Hi username! You've successfully authenticated, but GitHub does not provide shell access.&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id="step-5-push-changes"&gt;Step 5: Push Changes&lt;/h3&gt;
&lt;p&gt;Now you can push using the correct SSH key:&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;git push origin main&lt;/code&gt;&lt;/pre&gt;</description><category>git</category><category>github</category><category>ssh</category><category>win</category><category>windows</category><guid>https://til.code-drill.eu/posts/2025-07-06/how-use-multiple-ssh-keys-with-git/</guid><pubDate>Sun, 06 Jul 2025 15:15:20 GMT</pubDate></item><item><title>Simple Domain Redirect On AWS</title><link>https://til.code-drill.eu/posts/2025-06-29/simple-domain-redirect-on-aws/</link><dc:creator>Michał Rutkowski</dc:creator><description>&lt;p&gt;Assuming you have some domain configured on AWS using Route 53: &lt;a href="https://example.eu"&gt;example.eu&lt;/a&gt;&lt;br&gt;
And now you want to redirect all traffic from &lt;a href="https://example.eu"&gt;example.eu&lt;/a&gt; to &lt;a href="https://blog.example.eu"&gt;blog.example.eu&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="step-1-create-s3-bucket"&gt;Step 1: Create S3 Bucket&lt;/h3&gt;
&lt;ol type="1"&gt;
&lt;li&gt;S3 Console -&amp;gt; Create bucket&lt;/li&gt;
&lt;li&gt;Bucket name: &lt;code&gt;example.eu&lt;/code&gt; (must match your domain
exactly)&lt;/li&gt;
&lt;li&gt;Keep all default settings -&amp;gt; Create bucket&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="step-2-configure-s3-for-redirect"&gt;Step 2: Configure S3 for
Redirect&lt;/h3&gt;
&lt;ol type="1"&gt;
&lt;li&gt;Select your bucket -&amp;gt; Properties tab&lt;/li&gt;
&lt;li&gt;Static website hosting -&amp;gt; Edit&lt;/li&gt;
&lt;li&gt;Enable static website hosting&lt;/li&gt;
&lt;li&gt;Hosting type: Redirect requests for an object&lt;/li&gt;
&lt;li&gt;Host name: &lt;code&gt;blog.example.eu&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Protocol: &lt;code&gt;https&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Save changes&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Copy the S3 website endpoint (e.g.,
&lt;code&gt;http://example.eu.s3-website-us-east-1.amazonaws.com&lt;/code&gt;)&lt;/p&gt;
&lt;h3 id="step-3-request-ssl-certificate"&gt;Step 3: Request SSL
Certificate&lt;/h3&gt;
&lt;p&gt;Important: Must be done in us-east-1 region&lt;/p&gt;
&lt;ol type="1"&gt;
&lt;li&gt;Certificate Manager -&amp;gt; Request certificate&lt;/li&gt;
&lt;li&gt;Domain name: &lt;code&gt;example.eu&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Validation: DNS validation&lt;/li&gt;
&lt;li&gt;Request certificate&lt;/li&gt;
&lt;li&gt;Create records in Route 53 (button will appear)&lt;/li&gt;
&lt;li&gt;Wait for “Issued” status (5-10 minutes)&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="step-4-create-cloudfront-distribution"&gt;Step 4: Create CloudFront
Distribution&lt;/h3&gt;
&lt;ol type="1"&gt;
&lt;li&gt;CloudFront Console -&amp;gt; Create distribution&lt;/li&gt;
&lt;li&gt;Origin domain: Paste your S3 website endpoint from Step 2 (e.g.,
&lt;code&gt;http://example.eu.s3-website-us-east-1.amazonaws.com&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;Protocol: HTTP only&lt;/li&gt;
&lt;li&gt;Viewer protocol policy: Redirect HTTP to HTTPS&lt;/li&gt;
&lt;li&gt;Alternate domain names: &lt;code&gt;example.eu&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;SSL certificate: Select your certificate from Step 3&lt;/li&gt;
&lt;li&gt;Create distribution&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Wait 15-20 minutes for deployment&lt;/p&gt;
&lt;h3 id="step-5-update-route-53"&gt;Step 5: Update Route 53&lt;/h3&gt;
&lt;ol type="1"&gt;
&lt;li&gt;Route 53 -&amp;gt; Hosted zones -&amp;gt; example.eu&lt;/li&gt;
&lt;li&gt;Create record&lt;/li&gt;
&lt;li&gt;Record name: Leave empty&lt;/li&gt;
&lt;li&gt;Record type: A&lt;/li&gt;
&lt;li&gt;Alias: Yes&lt;/li&gt;
&lt;li&gt;Route traffic to: CloudFront distribution&lt;/li&gt;
&lt;li&gt;Select your distribution&lt;/li&gt;
&lt;li&gt;Create records&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Wait 5~20 minutes, then test:&lt;br&gt;
- Opening &lt;code&gt;http://example.eu&lt;/code&gt; -&amp;gt; should redirect to
&lt;code&gt;https://blog.example.eu&lt;/code&gt;&lt;br&gt;
- Opening &lt;code&gt;https://example.eu&lt;/code&gt; -&amp;gt; should redirect to
&lt;code&gt;https://blog.example.eu&lt;/code&gt;&lt;/p&gt;</description><category>aws</category><category>route 53</category><category>s3</category><guid>https://til.code-drill.eu/posts/2025-06-29/simple-domain-redirect-on-aws/</guid><pubDate>Sun, 29 Jun 2025 19:58:07 GMT</pubDate></item><item><title>Using top in mongodb aggregation</title><link>https://til.code-drill.eu/posts/2025-06-22/using-top-in-mongodb-aggregation/</link><dc:creator>Michał Rutkowski</dc:creator><description>&lt;p&gt;As mongo docs says:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;MongoDB aggregation stage limits
Each stage can use up to 100 MB of RAM. You will get an error from the database if you exceed this limit. &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So if you are having this problem and you need the first (or last)
element from a sorted collection, you can use the top operator.&lt;/p&gt;
&lt;p&gt;So instead of sorting:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;db.Entity.aggregate([
    {
        "$match": {
            "startTime": {
                "$gte": ISODate("2025-04-02T22:00:00Z"),
                "$lt": ISODate("2025-04-03T22:00:00Z")
                }
            }
        },
    {
        "$addFields": {
            "creatorPriority": {
                "$switch": {
                    "branches": [
                        { "case": { "$eq": ["$creator", "ADMIN"] }, "then": 1 }
                        ],
                    "default": 0
                    }
                }
            }
        },
    {
        "$sort": {
            "creatorPriority": -1,
            "createdAt": -1
            }
        },
    {
        "$group": {
            "_id": {
                "deviceId": "$deviceId",
                "startTime": "$startTime"
                },
            "records": { "$push": "$$CURRENT" }
            }
        },
    {
        "$replaceRoot": {
            "newRoot": { "$first": "$records" }
            }
        }
    ])
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Use top:&lt;/p&gt;
&lt;pre class="mongodb"&gt;&lt;code&gt;db.Entity.aggregate([
    {
        "$match": {
            "startTime": {
                "$gte": ISODate("2025-06-18T22:00:00Z"),
                "$lt": ISODate("2025-06-20T22:00:00Z")
                }
            }
        },
    {
        "$addFields": {
            "creatorPriority": {
                "$switch": {
                    "branches": [
                        { "case": { "$eq": ["$creator", "ADMIN"] }, "then": 1 }
                        ],
                    "default": 0
                }
            }
        }
    },

    {
        "$group": {
            "_id": {
                "entityId": "$entityId",
                "startTime": "$startTime"
                },
            "topRecord": {
                "$top": {
                    "sortBy": { "createdAt": -1 },
                    "output": "$$ROOT"
                    }
                }
            }
        },
    {
        "$replaceRoot": {
            "newRoot": "$topRecord"
            }
        }
    ] , {
    allowDiskUse: false
    })
&lt;/code&gt;&lt;/pre&gt;</description><category>aggregation</category><category>db</category><category>mongodb</category><category>top</category><guid>https://til.code-drill.eu/posts/2025-06-22/using-top-in-mongodb-aggregation/</guid><pubDate>Sun, 22 Jun 2025 18:59:15 GMT</pubDate></item><item><title>Gitignore windows cmd util</title><link>https://til.code-drill.eu/posts/2025-06-22/gitignore-windows-cmd-util/</link><dc:creator>Michał Rutkowski</dc:creator><description>&lt;p&gt;Simple utility that lets you generate .gitignore using cmd/shell. You
must have curl in your path.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;windows/cmd: &lt;code&gt;gitignore.cmd&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="cmd"&gt;&lt;code&gt;@echo off
curl -sL https://www.toptal.com/developers/gitignore/api/%*&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;linux - add function into your aliases file or .*rc
&lt;ul&gt;
&lt;li&gt;function for alias&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="shell"&gt;&lt;code&gt;function gitignore() { curl -sL https://www.toptal.com/developers/gitignore/api/\$@ ;}&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;zsh - code to run to add function to &lt;code&gt;.zshrc&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="shell"&gt;&lt;code&gt;echo "function gitignore() { curl -sL https://www.toptal.com/developers/gitignore/api/\$@ ;}" &amp;gt;&amp;gt; ~/.zshrc&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;bash - code to run to add function to &lt;code&gt;.bash&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="shell"&gt;&lt;code&gt;echo "function gitignore() { curl -sL https://www.toptal.com/developers/gitignore/api/\$@ ;}" &amp;gt;&amp;gt; ~/.bashrc&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;and than you can type:&lt;/p&gt;
&lt;pre class="shell"&gt;&lt;code&gt;gitignore python,pycharm,django&lt;/code&gt;&lt;/pre&gt;</description><category>bash</category><category>cmd</category><category>command-line</category><category>git</category><category>gitignore</category><category>linux</category><category>windows</category><category>zsh</category><guid>https://til.code-drill.eu/posts/2025-06-22/gitignore-windows-cmd-util/</guid><pubDate>Sun, 22 Jun 2025 11:47:35 GMT</pubDate></item></channel></rss>